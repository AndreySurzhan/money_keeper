<div class="component-container col-md-12">
    <div class="panel panel-default">
        <div class="panel-heading">
            <div class="panel-title-box">
                <h3>
                    {{ 'components.transactions.import.header.easyfinance' | translate }}
                </h3>
            </div>
        </div>
        <div class="panel-body">
            <!-- Upload file box -->
            <div id="pick-file-block"
                 ng-show="formState.uploadFile.visible">
                <div ng-model="files"
                     ngf-drop
                     ngf-select
                     ngf-allow-dir="formState.uploadFile.allowDirectory"
                     ngf-drag-over-class="dragover"
                     ngf-multiple="formState.uploadFile.allowMultipleFiles"
                     accept="formState.uploadFile.acceptedTypes"
                     class="drop-box">
                    <span>
                        {{ 'components.transactions.import.file-upload.placeholder' | translate }}
                    </span>
                </div>
                <div ngf-no-file-drop>
                    {{ 'components.transactions.import.file-upload.not-supported' | translate }}
                </div>
            </div>

            <!-- Uploading file progress box -->
            <div id="show-progress-block"
                 ng-show="formState.uploadingProgress.visible">
                <progressbar class="progress-striped active"
                             value="uploadingProgress"
                             type="success">
                    <b>{{ uploadingProgress }}%</b>
                </progressbar>
            </div>

            <!-- Categories matching box -->
            <div id="matching-block"
                 ng-show="formState.categoriesMatching.visible">
                <tabset>
                    <tab select="alertMe()">
                        <tab-heading>
                            Счета
                        </tab-heading>
                        <form name="accountsMatchingForm" class="form-horizontal">
                            <div ng-repeat="account in accounts"
                                 class="row">
                                <div class="col-md-6">
                                    <span>{{ account.name }}</span>
                                </div>
                                <div class="col-md-6">
                                    <select class="form-control"
                                            ng-model="account.matchedAccount"
                                            ng-options="account.name for account in myAccounts track by account._id"
                                            mk-required>
                                        <option value="">---</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </tab>
                    <tab select="alertMe()">
                        <tab-heading>
                            Категории доходов
                        </tab-heading>
                        <form name="incomeCategoriesMatchingForm" class="form-horizontal">
                            <div ng-repeat="category in incomeCategories"
                                 class="row">
                                <div class="col-md-6">
                                    <span>{{ category.name }}</span>
                                </div>
                                <div class="col-md-6">
                                    <select class="form-control"
                                            ng-model="category.matchedCategory"
                                            ng-options="category.name for category in myIncomeCategories track by category._id"
                                            mk-required>
                                        <option value="">---</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </tab>
                    <tab select="alertMe()">
                        <tab-heading>
                            Категории доходов
                        </tab-heading>
                        <form name="outcomeCategoriesMatchingForm" class="form-horizontal">
                            <div ng-repeat="category in outcomeCategories"
                                 class="row">
                                <div class="col-md-6">
                                    <span>{{ category.name }}</span>
                                </div>
                                <div class="col-md-6">
                                    <select class="form-control"
                                            ng-model="category.matchedCategory"
                                            ng-options="category.name for category in myOutcomeCategories track by category._id"
                                            mk-required>
                                        <option value="">---</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </tab>
                </tabset>
            </div>

            <!-- Error message box -->
            <div id="show-error-block"
                 ng-show="formState.errorMessage.visible">
                <div class="alert alert-danger" role="alert">
                    <strong>
                        {{ 'common.messages.error' | translate }}.
                    </strong>
                    {{ formState.errorMessage.message }}
                </div>
            </div>
        </div>
        <div class="panel-footer">
            <button class="btn btn-default" type="button" ng-click="cancel()">
                {{ 'common.buttons.cancel' | translate }}
            </button>
            <button ng-show="formState.categoriesMatching.nextButtonVisible"
                    ng-click="goNextTab()"
                    class="btn btn-primary pull-right" type="button">
                {{ 'components.transactions.import.matching.next-tab' | translate }}
            </button>
            <button ng-show="formState.categoriesMatching.importButtonVisible"
                    ng-click="import()"
                    class="btn btn-primary pull-right" type="button">
                {{ 'common.buttons.import' | translate }}
            </button>
        </div>
    </div>
</div>
